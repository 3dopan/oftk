# Ofkt ユーザーガイド

**バージョン**: 0.1.0
**最終更新**: 2026-01-25

---

## 目次

1. [はじめに](#はじめに)
2. [インストールとセットアップ](#インストールとセットアップ)
3. [基本的な使い方](#基本的な使い方)
4. [詳細機能ガイド](#詳細機能ガイド)
5. [設定とカスタマイズ](#設定とカスタマイズ)
6. [トラブルシューティング](#トラブルシューティング)
7. [よくある質問（FAQ）](#よくある質問faq)
8. [用語集](#用語集)

---

## はじめに

### Ofktとは

Ofkt（Overflow Filer Kaiten）は、頻繁に使用するフォルダやファイルに素早くアクセスするための常駐型ツールです。Windowsエクスプローラーの代替として、以下のような課題を解決します：

- **深い階層のフォルダへのアクセスが面倒**
  - エイリアス機能で、"会計"と入力するだけで"C:\Documents\2025年度\経理\会計資料"にアクセス

- **よく使うフォルダを探すのに時間がかかる**
  - お気に入り機能と履歴機能で、最近使ったフォルダや頻繁に使うフォルダが自動的に上位に表示

- **ファイル管理の操作が遅い**
  - ホットキーや画面端トリガーで瞬時にウィンドウを呼び出し、キーボード操作だけで完結

### 対象ユーザー

- 毎日多くのフォルダやファイルを扱うビジネスパーソン
- プロジェクトごとに深い階層のフォルダ構造を持つ開発者
- 効率的なファイル管理を求める方

---

## インストールとセットアップ

### システム要件

- **OS**: Windows 10/11（64bit）
- **メモリ**: 最小 100MB
- **ディスク**: 約 10MB
- **その他**: .NET Framework不要（スタンドアロン実行可能）

### インストール手順

#### オプション1: ビルド済みバイナリ（将来リリース予定）

1. GitHubのReleasesページからzipファイルをダウンロード
2. 任意のフォルダに解凍
3. `ofkt.exe`をダブルクリックして起動

#### オプション2: ソースからビルド

1. Rustをインストール（https://rustup.rs/）
2. リポジトリをクローン
   ```bash
   git clone https://github.com/yourusername/ofkt.git
   cd ofkt
   ```
3. リリースビルド
   ```bash
   cargo build --release
   ```
4. 実行ファイルをコピー
   ```bash
   copy target\release\ofkt.exe C:\Program Files\Ofkt\
   ```

### 初回起動

1. `ofkt.exe`を実行
2. システムトレイにアイコンが表示されます
3. 設定ファイルが自動的に作成されます
   - 場所: `%APPDATA%\ofkt\`
   - ファイル: `config.json`, `aliases.json`

### 自動起動の設定

1. システムトレイアイコンを右クリック
2. 「設定」をクリック
3. 「自動起動」タブで「Windows起動時に自動起動」にチェック
4. 「保存」をクリック

これで、次回のWindows起動時から自動的にOfktが起動します。

---

##基本的な使い方

### ウィンドウの表示/非表示

Ofktのウィンドウを表示するには、以下の3つの方法があります：

#### 1. ホットキー（推奨）

デフォルト: **Ctrl+Shift+O**

- どのアプリケーションを使用していても、このキーを押すだけでOfktが前面に表示されます
- もう一度押すと非表示になります
- ホットキーは設定画面でカスタマイズ可能です

#### 2. 画面端トリガー

- マウスカーソルを画面の**右端**に移動
- 約300ms（0.3秒）そのまま待つ
- 自動的にOfktが表示されます
- カーソルを離すと自動的に非表示になります

#### 3. システムトレイアイコン

- システムトレイ（タスクバーの右下）のOfktアイコンを左クリック
- ウィンドウが表示されます

### エイリアスの追加

エイリアスは、長いパスを短い名前で登録する機能です。

#### 手順

1. Ofktのウィンドウを表示
2. 「設定」タブをクリック
3. 「エイリアス管理」セクションで「新規追加」ボタンをクリック
4. 以下を入力：
   - **名前**: エイリアスの名前（例: "会計"）
   - **パス**: 実際のフォルダパス（例: "C:\Documents\2025年度\経理\会計資料"）
   - **タグ**: 分類用のタグ（例: "仕事, 経理"）※カンマ区切り
   - **色**: 視覚的な識別のための色（オプション）
5. 「追加」ボタンをクリック

#### 例

| 名前 | パス | タグ |
|------|------|------|
| 会計 | C:\Documents\2025年度\経理\会計資料 | 仕事, 経理 |
| プロジェクトA | C:\Projects\ClientA\ProjectA | 仕事, プロジェクト |
| 個人写真 | D:\Photos\Personal | 個人, 写真 |

### 検索とアクセス

#### 基本的な検索

1. Ofktのウィンドウを表示
2. 検索バーに名前を入力
3. リアルタイムで結果が絞り込まれます
4. 目的のエイリアスをダブルクリック（またはEnter）でフォルダが開きます

#### 検索の種類

##### 1. 完全一致
```
入力: 会計
結果: "会計" というエイリアスが表示されます
```

##### 2. 前方一致
```
入力: プロジェ
結果: "プロジェクトA", "プロジェクトB" など、"プロジェ"で始まるエイリアスが表示されます
```

##### 3. ファジーマッチング
```
入力: kkt
結果: "会計" (kaikei) がファジーマッチで提案されます
```

##### 4. タグ検索
```
入力: 仕事
結果: タグに"仕事"が含まれるすべてのエイリアスが表示されます
```

##### 5. 階層検索
```
入力: 試算表 202506
結果: "2025年度/会計/試算表/202506" のように階層構造を認識して検索
```

### ファイル操作

エイリアスを右クリックすると、以下の操作ができます：

- **開く**: フォルダをエクスプローラーで開く、またはファイルを関連アプリで開く
- **コピー**: ファイルまたはフォルダをコピー
- **移動**: ファイルまたはフォルダを移動
- **削除**: ファイルまたはフォルダを削除（デフォルトではゴミ箱へ移動）
- **名前変更**: ファイルまたはフォルダの名前を変更

---

## 詳細機能ガイド

### お気に入り機能

頻繁に使うエイリアスを「お気に入り」として登録できます。

#### お気に入りに追加

1. エイリアスの横にある**星アイコン**をクリック
2. 星が塗りつぶされた状態になります
3. お気に入りは検索結果の上位に表示されます

#### お気に入りの解除

1. お気に入りの星アイコンをもう一度クリック
2. 星が空洞の状態に戻ります

#### お気に入りのメリット

- 検索結果で**自動的に上位に表示**される（+50点のスコアブースト）
- よく使うフォルダに素早くアクセスできる

### 履歴機能

最近開いたファイルやフォルダが自動的に記録されます。

#### 履歴の確認

1. Ofktのウィンドウを表示
2. 「履歴」タブをクリック
3. 最近開いたアイテムが新しい順に表示されます

#### 履歴からアクセス

1. 履歴リストからアイテムを選択
2. ダブルクリック（またはEnter）で開く

#### 履歴のクリア

1. 「履歴」タブで「すべてクリア」ボタンをクリック
2. すべての履歴が削除されます

### スコアリングシステム

検索結果は以下の基準で自動的にスコアリングされ、上位に表示されます：

1. **お気に入り**: +50点
2. **最終アクセス日時**:
   - 7日以内: +20点
   - 30日以内: +10点
3. **マッチの種類**:
   - 完全一致: 高スコア
   - 前方一致: 中スコア
   - ファジーマッチ: 類似度に応じたスコア

### タグ機能

エイリアスに複数のタグを付けて分類できます。

#### タグの追加

1. エイリアスの編集画面で「タグ」フィールドにカンマ区切りで入力
   - 例: `仕事, 経理, 2025年度`
2. 保存すると、タグが登録されます

#### タグで検索

1. 検索バーにタグ名を入力
2. そのタグが付いたすべてのエイリアスが表示されます

#### タグの活用例

- **プロジェクト別**: `プロジェクトA`, `プロジェクトB`
- **年度別**: `2024年度`, `2025年度`
- **分類別**: `仕事`, `個人`, `趣味`
- **重要度別**: `重要`, `アーカイブ`

### カラーラベル

エイリアスに色を付けて視覚的に識別できます。

#### 色の設定

1. エイリアスの編集画面で「色」ドロップダウンから選択
2. 赤、青、緑、黄、紫などから選べます

#### 色の活用例

- **優先度**: 赤=最優先、黄=通常、灰=低優先度
- **状態**: 緑=進行中、青=完了、赤=問題あり
- **分類**: チームごとに異なる色を割り当て

---

## 設定とカスタマイズ

設定画面は、システムトレイアイコン → 「設定」、またはOfktウィンドウの「設定」タブから開けます。

### ホットキー設定

**デフォルト**: Ctrl+Shift+O

#### 変更方法

1. 「設定」タブを開く
2. 「ホットキー」セクションで以下を選択：
   - **Ctrl**: チェックボックスで有効/無効
   - **Shift**: チェックボックスで有効/無効
   - **Alt**: チェックボックスで有効/無効
   - **キー**: ドロップダウンで選択（A-Z, 0-9, F1-F12など）
3. 「保存」をクリック

#### おすすめの組み合わせ

- `Ctrl+Shift+O` (デフォルト)
- `Ctrl+Alt+F` (ファイラーのF)
- `Ctrl+Shift+Space`

### 画面端トリガー設定

**デフォルト**: 有効、右端、300ms

#### 変更方法

1. 「設定」タブを開く
2. 「画面端トリガー」セクションで以下を設定：
   - **有効/無効**: チェックボックス
   - **検出時間**: スライダーで調整（100ms～1000ms）
3. 「保存」をクリック

#### 検出時間の目安

- **100ms**: 非常に敏感（誤反応しやすい）
- **300ms**: バランスが良い（デフォルト）
- **500ms**: 意図的な操作のみ反応
- **1000ms**: かなり遅い

### 自動起動設定

**デフォルト**: 無効

#### 有効化

1. 「設定」タブを開く
2. 「自動起動」セクションで「Windows起動時に自動起動」にチェック
3. 「保存」をクリック
4. Windowsレジストリに登録されます

#### 無効化

1. チェックを外して「保存」をクリック
2. レジストリから削除されます

### テーマ設定

**デフォルト**: システム連動

#### テーマの種類

- **ライト**: 明るい色合い（白ベース）
- **ダーク**: 暗い色合い（黒ベース）
- **システム連動**: Windows設定に応じて自動切替

#### 変更方法

1. 「設定」タブを開く
2. 「テーマ」セクションでラジオボタンを選択
3. 即座にテーマが適用されます

### ウィンドウサイズ設定

**デフォルト**: 幅800px、高さ600px

#### 変更方法

##### 方法1: ドラッグでリサイズ
1. ウィンドウの端をドラッグしてサイズ変更
2. 次回起動時に自動的にサイズが保存されます

##### 方法2: 設定で指定
1. 「設定」タブを開く
2. 「ウィンドウ」セクションで幅と高さを入力
3. 「保存」をクリック

### 検索設定

#### 最大結果数

**デフォルト**: 100件

検索結果の最大表示件数を設定できます。

1. 「設定」タブを開く
2. 「検索」セクションで「最大結果数」を入力
3. 「保存」をクリック

#### キャッシュサイズ

**デフォルト**: 100件

検索結果をキャッシュする件数を設定できます。

1. 「設定」タブを開く
2. 「検索」セクションで「キャッシュサイズ」を入力
3. 「保存」をクリック

### ファイル操作設定

#### ゴミ箱を使用する

**デフォルト**: 有効

ファイル削除時にゴミ箱へ移動するか、完全削除するかを設定できます。

1. 「設定」タブを開く
2. 「ファイル操作」セクションで「削除時にゴミ箱を使用」にチェック
3. 「保存」をクリック

**注意**: チェックを外すと、削除時に完全削除されます（復元不可）。

---

## トラブルシューティング

### ホットキーが動作しない

#### 原因1: 他のアプリケーションと競合

**解決方法**:
1. 設定画面でホットキーを別の組み合わせに変更
2. 他のアプリケーション（例: IDE, ゲーム）のホットキー設定を確認

#### 原因2: 管理者権限

**解決方法**:
1. Ofktを管理者権限で実行
2. `ofkt.exe`を右クリック → 「管理者として実行」

### 画面端トリガーが反応しない

#### 原因1: WSL環境で実行している

**解決方法**: Windows環境で実行してください（WSLでは非対応）

#### 原因2: 無効になっている

**解決方法**:
1. 設定画面で「画面端トリガー」が有効になっているか確認
2. 検出時間を長めに設定してみる（例: 500ms）

#### 原因3: マルチモニター環境

**解決方法**:
1. 各モニターの右端で試してみる
2. プライマリモニターで確認

### システムトレイアイコンが表示されない

#### 原因1: Windowsのシステムトレイ設定

**解決方法**:
1. タスクバーを右クリック → 「タスクバーの設定」
2. 「システムトレイアイコンの選択」でOfktを有効化

#### 原因2: アプリケーションが起動していない

**解決方法**:
1. タスクマネージャーで`ofkt.exe`が実行中か確認
2. 実行されていない場合は再起動

### アプリケーションが起動しない

#### 原因1: WSL環境で実行している

**解決方法**: Windows環境で実行してください

#### 原因2: 設定ファイルが破損

**解決方法**:
1. 設定ファイルを削除
   - 場所: `%APPDATA%\ofkt\`
   - ファイル: `config.json`, `aliases.json`
2. Ofktを再起動（自動的に新しい設定ファイルが作成されます）

#### 原因3: 必要なDLLが不足

**解決方法**:
1. Visual C++ Redistributableをインストール
2. Windows Updateで最新の状態にする

### 検索結果が表示されない

#### 原因1: エイリアスが登録されていない

**解決方法**:
1. 「設定」タブでエイリアスを追加
2. エイリアスファイル（`aliases.json`）を確認

#### 原因2: 検索クエリが一致していない

**解決方法**:
1. タグ名で検索してみる
2. ファジーマッチングを活用（一部の文字だけ入力）

### ファイル操作が失敗する

#### 原因1: 権限不足

**解決方法**:
1. 管理者権限でOfktを実行
2. ファイルやフォルダの権限を確認

#### 原因2: ファイルが使用中

**解決方法**:
1. 該当ファイルを使用しているアプリケーションを閉じる
2. ファイルロックを解除

### 設定が保存されない

#### 原因1: ファイルが読み取り専用

**解決方法**:
1. `%APPDATA%\ofkt\config.json`の読み取り専用属性を解除
2. フォルダの権限を確認

#### 原因2: ディスク容量不足

**解決方法**:
1. ディスクの空き容量を確保
2. 設定ファイルのバックアップを削除

---

## よくある質問（FAQ）

### Q1: エイリアスはいくつまで登録できますか?

**A1**: 理論上は無制限ですが、パフォーマンスの観点から1,000件程度を推奨します。1,000件でも検索速度は50µs以下と非常に高速です。

### Q2: ネットワークドライブのフォルダもエイリアスに登録できますか?

**A2**: はい、可能です。ただし、ネットワークの状態によってはアクセスに時間がかかる場合があります。

### Q3: 複数のPCで設定を同期できますか?

**A3**: v0.1.0ではサポートしていません。設定ファイル（`%APPDATA%\ofkt\`）を手動でコピーすることで移行は可能です。将来的にクラウド同期機能を追加予定です。

### Q4: エイリアスをエクスポート/インポートできますか?

**A4**: v0.1.0ではGUI機能はありませんが、設定ファイル（`aliases.json`）を直接コピーすることで移行可能です。将来的にGUI対応予定です。

### Q5: macOSやLinuxでも使えますか?

**A5**: 現在はWindows専用です。クロスプラットフォーム対応は将来的な課題として検討中です。

### Q6: メモリ使用量はどのくらいですか?

**A6**: エイリアス1,000件でも約50MB程度です。非常に軽量に設計されています。

### Q7: 他のファイラーツールと併用できますか?

**A7**: はい、問題なく併用できます。Ofktは常駐型なので、必要な時だけ呼び出して使用できます。

### Q8: データのバックアップは必要ですか?

**A8**: 設定ファイル（`%APPDATA%\ofkt\`）を定期的にバックアップすることを推奨します。

### Q9: アンインストール方法は?

**A9**:
1. Ofktを終了（システムトレイ → 終了）
2. `ofkt.exe`を削除
3. 設定ファイルを削除（`%APPDATA%\ofkt\`）
4. 自動起動を有効にしていた場合は、設定画面で無効化してから削除

### Q10: 問題が発生した場合、どこに報告すればいいですか?

**A10**: GitHubのIssuesページで報告してください。バグ報告には以下の情報を含めてください：
- OSのバージョン
- Ofktのバージョン
- 発生した操作
- エラーメッセージ

---

## 用語集

### エイリアス
長いファイルパスを短い名前で登録したもの。例: "会計" → "C:\Documents\2025年度\経理\会計資料"

### ホットキー
アプリケーションを呼び出すためのキーボードショートカット。デフォルトはCtrl+Shift+O。

### 画面端トリガー
マウスカーソルを画面端に移動することでウィンドウを表示する機能。

### お気に入り
頻繁に使うエイリアスを星印でマークし、検索結果の上位に表示する機能。

### ファジーマッチング
曖昧な入力でも類似したエイリアスを提案する検索方法。例: "kkt" → "会計"（kaikei）

### 階層検索
複数のキーワードを入力してフォルダの階層構造を認識する検索方法。例: "試算表 202506"

### スコアリング
検索結果を関連性の高い順に並べるための評価システム。お気に入りや最終アクセス日時を考慮。

### システムトレイ
タスクバーの右下に常駐するアイコン領域。Ofktはここに常駐します。

### LRUキャッシュ
Least Recently Used（最も最近使われていない）キャッシュ。検索結果を一時保存して高速化。

### アトミック書き込み
設定ファイルの保存時にデータ破損を防ぐための安全な書き込み方法。

---

## サポート

さらに詳しい情報は以下を参照してください：

- **README.md** - プロジェクト概要
- **CHANGELOG.md** - バージョン履歴
- **INTEGRATION_TEST.md** - 統合テスト手順（開発者向け）
- **GitHub Issues** - バグ報告・機能提案

---

**作成日**: 2026-01-25
**バージョン**: 0.1.0
